amber                on
parmfile             chig.parm7
coordinates          output_min_eq/result.coor
extendedSystem       output_min_eq/result.xsc
velocities           output_min_eq/result.vel
outputName           output/free_energy

margin               1
timestep             2.0
rigidBonds           all

langevin             on
langevinDamping      1
langevinTemp         300
langevinHydrogen     no

langevinPiston       on
langevinPistonTarget 1.01325
langevinPistonPeriod 200.0
langevinPistonDecay  100.0
langevinPistonTemp   300
useGroupPressure     yes
useFlexibleCell      no
useConstantArea      no
useConstantRatio     no

restartfreq          5000
dcdfreq              5000
xstFreq              5000
outputEnergies       1000
outputPressure       1000
outputTiming         50000
firsttimestep        0

wrapWater            on
wrapAll              on

exclude              scaled1-4
1-4scaling           0.83333333
cutoff               10.0
switching            on
switchdist           9.0
pairlistdist         12.0
VDWForceSwitching    on
LJcorrection         on
scnb                 2.0

nonbondedFreq        1
fullElectFrequency   2
longSplitting        c1
stepspercycle        20

PME                  yes
PMEGridSpacing       1.2

colvars                 on

accelMD                         on
accelMDG                        on
accelMDGcMDSteps                3000000
accelMDGcMDPrepSteps            900000
accelMDGEquiPrepSteps           900000
accelMDGEquiSteps               3000000
accelMDdihe                     on
accelMDOutFreq                  5000
accelMDGSigma0D                 6.0

for {set stage 0} {$stage < 2} {incr stage} {
    # preparing stage: probing the GaMD parameters
    # from an equilibrium simulation
    if {$stage == 0} {
        puts "Probing the GaMD parameters..."
        cv configfile 002_free_energy_prepare.in
        run norepeat  6000000
    # production stage: eABF + GaMDD
    } elseif {$stage == 1} {
        puts "Starting eABF + GaMD..."
        cv reset
        cv configfile 002_free_energy.in
        run norepeat 1000000000
    }
}
